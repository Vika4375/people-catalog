import streamlit as st
import json

st.set_page_config(page_title="üë• –ö–∞—Ç–∞–ª–æ–≥ –ª—é–¥–µ–π", page_icon="üìñ")

st.title("üë• –ö–∞—Ç–∞–ª–æ–≥ –ª—é–¥–µ–π")

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ JSON-—Ñ–∞–π–ª—É
with open("lyudy.json", "r", encoding="utf-8") as —Ñ–∞–π–ª:
    –ª—é–¥–∏ = json.load(—Ñ–∞–π–ª)

# üîç –ü–æ—à—É–∫ –∑–∞ —ñ–º º—è–º
—ñ–º–µ–Ω–∞ = [–ª—é–¥–∏–Ω–∞["—ñ–º'—è"] for –ª—é–¥–∏–Ω–∞ in –ª—é–¥–∏]
–≤–∏–±—Ä–∞–Ω–µ_—ñ–º º—è = st.selectbox("üîé –û–±–µ—Ä–∏ —ñ–º‚Äô—è –¥–ª—è –ø–æ—à—É–∫—É:", —ñ–º–µ–Ω–∞)

# –í–∏–≤–µ–¥–µ–Ω–Ω—è –æ–±—Ä–∞–Ω–æ—ó –ª—é–¥–∏–Ω–∏
for –ª—é–¥–∏–Ω–∞ in –ª—é–¥–∏:
    if –ª—é–¥–∏–Ω–∞["—ñ–º'—è"] == –≤–∏–±—Ä–∞–Ω–µ_—ñ–º º—è:
        st.write(f"**–Ü–º º—è:** {–ª—é–¥–∏–Ω–∞['—ñ–º\'—è']}")
        st.write(f"**–í—ñ–∫:** {–ª—é–¥–∏–Ω–∞['–≤—ñ–∫']}")
        st.write(f"**–ú—ñ—Å—Ç–æ:** {–ª—é–¥–∏–Ω–∞['–º—ñ—Å—Ç–æ']}")
        st.write(f"**–£–ª—é–±–ª–µ–Ω–∞ –º—É–∑–∏–∫–∞:** {–ª—é–¥–∏–Ω–∞['—É–ª—é–±–ª–µ–Ω–∞ –º—É–∑–∏–∫–∞']}")

# üßπ –§—ñ–ª—å—Ç—Ä –∑–∞ –º—ñ—Å—Ç–æ–º
—É—Å—ñ_–º—ñ—Å—Ç–∞ = sorted(set(–ª—é–¥–∏–Ω–∞["–º—ñ—Å—Ç–æ"] for –ª—é–¥–∏–Ω–∞ in –ª—é–¥–∏))
–º—ñ—Å—Ç–æ = st.selectbox("üèô –û–±–µ—Ä–∏ –º—ñ—Å—Ç–æ:", —É—Å—ñ_–º—ñ—Å—Ç–∞)

st.write(f"### –õ—é–¥–∏ –∑ –º—ñ—Å—Ç–∞ {–º—ñ—Å—Ç–æ}:")
for –ª—é–¥–∏–Ω–∞ in –ª—é–¥–∏:
    if –ª—é–¥–∏–Ω–∞["–º—ñ—Å—Ç–æ"] == –º—ñ—Å—Ç–æ:
        st.write(f"‚Ä¢ {–ª—é–¥–∏–Ω–∞['—ñ–º\'—è']} ({–ª—é–¥–∏–Ω–∞['–≤—ñ–∫']} —Ä–æ–∫—ñ–≤)")

# üëµ –§—ñ–ª—å—Ç—Ä –∑–∞ –≤—ñ–∫–æ–º
–º—ñ–Ω_–≤—ñ–∫ = st.slider("üë∂ –ü–æ–∫–∞–∑–∞—Ç–∏ –ª—é–¥–µ–π –≤—ñ–¥ –≤—ñ–∫—É:", min_value=0, max_value=100, value=30)
st.write(f"### –õ—é–¥–∏ –≤—ñ–¥ {–º—ñ–Ω_–≤—ñ–∫} —Ä–æ–∫—ñ–≤:")
for –ª—é–¥–∏–Ω–∞ in –ª—é–¥–∏:
    if –ª—é–¥–∏–Ω–∞["–≤—ñ–∫"] >= –º—ñ–Ω_–≤—ñ–∫:
        st.write(f"‚Ä¢ {–ª—é–¥–∏–Ω–∞['—ñ–º\'—è']} ‚Äî {–ª—é–¥–∏–Ω–∞['–≤—ñ–∫']} —Ä–æ–∫—ñ–≤")
st.markdown("---")
st.subheader("‚ûï –î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –ª—é–¥–∏–Ω—É:")

–∑_—ñ–º º—è = st.text_input("–Ü–º º—è")
–∑_–≤—ñ–∫ = st.number_input("–í—ñ–∫", min_value=0, max_value=120, step=1)
–∑_–º—ñ—Å—Ç–æ = st.text_input("–ú—ñ—Å—Ç–æ")
–∑_–º—É–∑–∏–∫–∞ = st.text_input("–£–ª—é–±–ª–µ–Ω–∞ –º—É–∑–∏–∫–∞")

if st.button("‚úÖ –î–æ–¥–∞—Ç–∏"):
    –Ω–æ–≤–∞_–ª—é–¥–∏–Ω–∞ = {
        "—ñ–º'—è": –∑_—ñ–º º—è,
        "–≤—ñ–∫": –∑_–≤—ñ–∫,
        "–º—ñ—Å—Ç–æ": –∑_–º—ñ—Å—Ç–æ,
        "—É–ª—é–±–ª–µ–Ω–∞ –º—É–∑–∏–∫–∞": –∑_–º—É–∑–∏–∫–∞
    }

    –ª—é–¥–∏.append(–Ω–æ–≤–∞_–ª—é–¥–∏–Ω–∞)

    # –ü–µ—Ä–µ–∑–∞–ø–∏—Å—É—î–º–æ —Ñ–∞–π–ª
    with open("lyudy.json", "w", encoding="utf-8") as —Ñ–∞–π–ª:
        json.dump(–ª—é–¥–∏, —Ñ–∞–π–ª, ensure_ascii=False, indent=4)

    st.success(f"üôå –î–æ–¥–∞–Ω–æ {–∑_—ñ–º º—è} –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É!")
    st.rerun()
st.markdown("---")
st.subheader("üìù –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª–∏—Ç–∏ –ª—é–¥–∏–Ω—É:")

–æ–±—Ä–∞–Ω–∞_–ª—é–¥–∏–Ω–∞ = st.selectbox("üîΩ –û–±–µ—Ä–∏ —ñ–º º—è –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –∞–±–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è:", —ñ–º–µ–Ω–∞)

# –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Å–ª–æ–≤–Ω–∏–∫ —Ü—ñ—î—ó –ª—é–¥–∏–Ω–∏
–≤–∏–±—Ä–∞–Ω–∞ = next((–ª for –ª in –ª—é–¥–∏ if –ª["—ñ–º'—è"] == –æ–±—Ä–∞–Ω–∞_–ª—é–¥–∏–Ω–∞), None)

if –≤–∏–±—Ä–∞–Ω–∞:
    –Ω–æ–≤–µ_—ñ–º º—è = st.text_input("–Ü–º º—è", value=–≤–∏–±—Ä–∞–Ω–∞["—ñ–º'—è"])
    –Ω–æ–≤–∏–π_–≤—ñ–∫ = st.number_input("–í—ñ–∫", min_value=0, max_value=120, value=–≤–∏–±—Ä–∞–Ω–∞["–≤—ñ–∫"])
    –Ω–æ–≤–µ_–º—ñ—Å—Ç–æ = st.text_input("–ú—ñ—Å—Ç–æ", value=–≤–∏–±—Ä–∞–Ω–∞["–º—ñ—Å—Ç–æ"])
    –Ω–æ–≤–∞_–º—É–∑–∏–∫–∞ = st.text_input("–£–ª—é–±–ª–µ–Ω–∞ –º—É–∑–∏–∫–∞", value=–≤–∏–±—Ä–∞–Ω–∞["—É–ª—é–±–ª–µ–Ω–∞ –º—É–∑–∏–∫–∞"])

    if st.button("üíæ –û–Ω–æ–≤–∏—Ç–∏"):
        –≤–∏–±—Ä–∞–Ω–∞["—ñ–º'—è"] = –Ω–æ–≤–µ_—ñ–º º—è
        –≤–∏–±—Ä–∞–Ω–∞["–≤—ñ–∫"] = –Ω–æ–≤–∏–π_–≤—ñ–∫
        –≤–∏–±—Ä–∞–Ω–∞["–º—ñ—Å—Ç–æ"] = –Ω–æ–≤–µ_–º—ñ—Å—Ç–æ
        –≤–∏–±—Ä–∞–Ω–∞["—É–ª—é–±–ª–µ–Ω–∞ –º—É–∑–∏–∫–∞"] = –Ω–æ–≤–∞_–º—É–∑–∏–∫–∞

        with open("lyudy.json", "w", encoding="utf-8") as —Ñ–∞–π–ª:
            json.dump(–ª—é–¥–∏, —Ñ–∞–π–ª, ensure_ascii=False, indent=4)

        st.success("‚úÖ –î–∞–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–æ!")
        st.rerun()

    if st.button("üóë –í–∏–¥–∞–ª–∏—Ç–∏"):
        –ª—é–¥–∏.remove(–≤–∏–±—Ä–∞–Ω–∞)

        with open("lyudy.json", "w", encoding="utf-8") as —Ñ–∞–π–ª:
            json.dump(–ª—é–¥–∏, —Ñ–∞–π–ª, ensure_ascii=False, indent=4)

        st.warning("üö´ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∏–¥–∞–ª–µ–Ω–æ.")
        st.rerun()
st.markdown("---")
st.subheader("üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")

# –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å
st.write(f"üë• –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ª—é–¥–µ–π: {len(–ª—é–¥–∏)}")

# –°–µ—Ä–µ–¥–Ω—ñ–π –≤—ñ–∫
if –ª—é–¥–∏:
    —Å–µ—Ä–µ–¥–Ω—ñ–π_–≤—ñ–∫ = sum(–ª["–≤—ñ–∫"] for –ª in –ª—é–¥–∏) / len(–ª—é–¥–∏)
    st.write(f"üìà –°–µ—Ä–µ–¥–Ω—ñ–π –≤—ñ–∫: {—Å–µ—Ä–µ–¥–Ω—ñ–π_–≤—ñ–∫:.1f} —Ä–æ–∫—ñ–≤")

# –°–∫—ñ–ª—å–∫–∏ –ª—é–¥–µ–π –∑ –∫–æ–∂–Ω–æ–≥–æ –º—ñ—Å—Ç–∞
–º—ñ—Å—Ç–∞_—Ä–∞—Ö—É–Ω–æ–∫ = {}
for –ª in –ª—é–¥–∏:
    –º—ñ—Å—Ç–æ = –ª["–º—ñ—Å—Ç–æ"]
    –º—ñ—Å—Ç–∞_—Ä–∞—Ö—É–Ω–æ–∫[–º—ñ—Å—Ç–æ] = –º—ñ—Å—Ç–∞_—Ä–∞—Ö—É–Ω–æ–∫.get(–º—ñ—Å—Ç–æ, 0) + 1

st.write("üèô –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—é–¥–µ–π –ø–æ –º—ñ—Å—Ç–∞—Ö:")
for –º, –∫ in –º—ñ—Å—Ç–∞_—Ä–∞—Ö—É–Ω–æ–∫.items():
    st.write(f"‚Ä¢ {–º}: {–∫} –æ—Å—ñ–±")

